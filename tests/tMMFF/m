def getBuffs( NEIGH_MAX=4 ):
    #init_buffers()
    #natom=nnode+ncap
    #nvecs=natom+npi
    #nDOFs=nvecs*3
    global ffflags
    ffflags = getBBuff( "ffflags" , (14,) )
    global ndims,Es
    ndims = getIBuff( "ndims", (9,) )  # [nDOFs,natoms,nnode,ncap,npi,nbonds]
    global nDOFs,natoms,nnode,ncap,npi,nvecs,nbonds,ne,ie0
    # MFF_lib.cpp::init_buffers() ndims{nDOFs=9,natoms=3,nnode=1,ncap=2,npi=0,nbonds=2,nvecs=3,ne=0,ie0=3}
    nDOFs=ndims[0]; natoms=ndims[1];  nnode=ndims[2]; ncap=ndims[3]; npi=ndims[4]; nbonds=ndims[5]; nvecs=ndims[6]; ne=ndims[7]; ie0=ndims[8]
    print( "getBuffs(): nDOFs=%i nvecs=%i  natoms=%i nnode=%i ncap=%i npi=%i nbonds=%i nvecs=%i ne=%i ie0=%i " %(nDOFs,nvecs,natoms,nnode,ncap,npi,nbonds,nvecs,ne,ie0) )
    Es    = getBuff ( "Es",    (6,) )  # [ Etot,Eb,Ea, Eps,EppT,EppI; ]
    global DOFs,fDOFs,vDOFs,apos,fapos,REQs,PLQs,pipos,fpipos,bond_l0,bond_k, bond2atom,neighs,selection
    #Ebuf     = getEnergyTerms( )
    
    apos      = getBuff ( "apos",     (natoms,3) )
    fapos     = getBuff ( "fapos",    (natoms,3) )
    REQs      = getBuff ( "REQs",     (natoms,4) )
    PLQs      = getBuff ( "PLQs",     (natoms,4) )
    if glob_bMMFF:
        DOFs      = getBuff ( "DOFs",     (nvecs,3)  )
        fDOFs     = getBuff ( "fDOFs",    (nvecs,3)  ) 
        vDOFs     = getBuff ( "vDOFs",    (nvecs,3)  ) 
        pipos     = getBuff ( "pipos",    (npi,3)    )
        fpipos    = getBuff ( "fpipos",   (npi,3)    )
        #bond_l0   = getBuff ( "bond_l0",  (nbonds)   )
        #bond_k    = getBuff ( "bond_k",   (nbonds)   )
        #Kneighs   = getBuff ( "Kneighs",  (nnode,NEIGH_MAX) )
        #bond2atom = getIBuff( "bond2atom",(nbonds,2) )
        neighs   = getIBuff( "neighs",  (nnode,NEIGH_MAX) )
        selection = getIBuff( "selection",  (natoms) )
    print( "getBuffs DONE" )
